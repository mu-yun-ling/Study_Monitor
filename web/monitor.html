<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的学习宇宙</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <link rel="stylesheet" href="/style.css">
</head>
<body class="monitor-page">
    <!-- 走神警告遮罩 -->
    <div id="distractionOverlay" class="distraction-overlay">
        <div class="distraction-content">
            <div class="distraction-icon">😴</div>
            <h2>检测到走神！</h2>
            <p id="distractionReason">需要休息一下吗？学习要专注哦~</p>
            <button class="btn btn-primary btn-large" id="backToFocusBtn">我已回神</button>
        </div>
    </div>

    <!-- 顶部状态栏 -->
    <div class="top-bar">
        <div class="top-left">
            <button class="btn btn-small btn-secondary" id="backBtn">← 返回</button>
            <div class="mode-badge" id="modeBadge">📖 学习模式</div>
        </div>
        <div class="top-center">
            <div class="score-display">
                <span class="score-icon">🏆</span>
                <span class="score-value" id="currentScore">0</span>
                <span class="score-change" id="scoreChange"></span>
            </div>
        </div>
        <div class="top-right">
            <div class="session-timer" id="sessionTimer">00:00:00</div>
            <div class="status-indicator" id="statusIndicator">
                <span class="status-dot"></span>
                <span class="status-text">监控中</span>
            </div>
        </div>
    </div>

    <!-- 主内容区 -->
    <div class="monitor-main">
        <!-- 左侧：摄像头凹槽 + 番茄钟 -->
        <div class="pomodoro-section" id="pomodoroSection">
            <!-- 摄像头凹槽位置 -->
            <div class="pip-dock" id="pipDock">
                <div class="pip-dock-placeholder">
                    <span>📷 摄像头已分离，点击此处回归</span>
                </div>
            </div>
            
            <div class="pomodoro-card">
    <div class="pomodoro-header">
        <h2>🍅 番茄钟</h2>
        <div class="pomodoro-count">
            已完成 <span id="pomodoroCount">0</span> 个
        </div>
    </div>
    <div class="pomodoro-timer">
        <svg class="progress-ring" width="220" height="220">
            <circle class="progress-ring-bg" cx="110" cy="110" r="100"/>
            <circle class="progress-ring-fill" id="progressRing" cx="110" cy="110" r="100"/>
        </svg>
        <div class="timer-display">
            <div class="timer-time" id="pomodoroTime">25:00</div>
            <div class="timer-label" id="pomodoroLabel">专注时间</div>
            <div class="timer-cycle" id="pomodoroCycle"></div>
        </div>
    </div>
    <div class="pomodoro-controls">
        <button class="btn btn-primary" id="pomodoroStartBtn">▶ 开始</button>
        <button class="btn btn-secondary" id="pomodoroResetBtn">↺ 重置</button>
    </div>
    <div class="pomodoro-settings">
        <label>
            专注 <input type="number" id="focusDuration" value="25" min="1" max="1440"> 分钟
        </label>
        <label>
            休息 <input type="number" id="breakDuration" value="5" min="1" max="1440"> 分钟
        </label>
        <label>
            循环 <input type="number" id="cycleCount" value="4" min="1" max="20"> 次
        </label>
    </div>
</div>

        </div>

        <!-- 右侧：待办清单todolist -->
        <div class="todo-section">
            <div class="todo-card">
                <div class="todo-header">
                    <h2>📝 待办清单</h2>
                    <div class="todo-stats">
                        <span id="todoCompleted">0</span>/<span id="todoTotal">0</span> 已完成
                    </div>
                </div>
                <div class="todo-input-wrapper">
                    <input type="text" class="todo-input" id="todoInput" placeholder="添加新任务，按回车确认...">
                    <button class="btn btn-primary btn-small" id="addTodoBtn">+</button>
                </div>
                <ul class="todo-list" id="todoList">
                    <li class="todo-empty">暂无任务，添加一个开始学习吧！</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 可拖动/可停靠的摄像头画中画 -->
    <div class="pip-container docked" id="pipContainer">
        <div class="pip-header" id="pipHeader">
            <span class="pip-title">📷 实时监控</span>
            <div class="pip-actions">
                <button class="pip-btn" id="pipDockBtn" title="停靠/分离">⇱</button>
                <button class="pip-btn" id="pipToggle" title="折叠/展开">−</button>
            </div>
        </div>
        <div class="pip-content" id="pipContent">
            <img id="videoFeed" src="" alt="摄像头">
            <div class="pip-status">
                <span class="face-status" id="faceStatus">😊 专注中</span>
            </div>
        </div>
        <div class="pip-data" id="pipData">
            <div class="pip-data-item">
                <span class="pip-label">姿态</span>
                <span class="pip-value" id="poseData">P:0° Y:0°</span>
            </div>
        </div>
    </div>

    <!-- 警告边框 -->
    <div class="alert-border" id="alertBorder"></div>

    <!-- 右下角 Toast 通知容器 -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="/monitor.js"></script>
</body>
</html>